{% extends 'base.html' %}
{% block title %}Perfil{% endblock %}

{% block content %}
<h2>Perfil de {{ profile_user.username }}</h2>

<div class="mb-4">
    {% if profile %}
        {% if profile.avatar %}
            <img src="{{ profile.avatar.url }}" alt="Avatar" width="150" class="rounded-circle mb-3">
        {% endif %}
        {% if profile.bio %}
            <p>{{ profile.bio }}</p>
        {% endif %}
    {% else %}
        <p>No hay informaci칩n de perfil.</p>
    {% endif %}
    <p><strong>Suscriptores:</strong> {{ subscriber_count }}</p>

    {% if request.user == profile_user %}
        <a href="{% url 'blog:profile_edit' %}" class="btn btn-primary">Editar perfil</a>
    {% endif %}
</div>


<hr>

<!-- 游댒 SECCI칍N DE NOTIFICACIONES -->
{% if request.user == profile_user %}
<h3>游댒 Notificaciones</h3>
<ul class="list-group">
    {% for notification in notifications %}
        <li class="list-group-item {% if not notification.is_read %}fw-bold{% endif %}">
            {{ notification.message }}
            <a href="{% url 'blog:open_notification' notification.id %}">Ver</a>
            <small class="text-muted"> - {{ notification.created_at|timesince }} atr치s</small>
        </li>
    {% empty %}
        <li class="list-group-item">No tienes notificaciones.</li>
    {% endfor %}
</ul>
{% endif %}

<!-- Bot칩n de suscripci칩n -->
{% if request.user.is_authenticated and profile_user.username and request.user != profile_user %}
    {% if is_subscribed %}
        <form action="{% url 'blog:unsubscribe' profile_user.username %}" method="post">
            {% csrf_token %}
            <button type="submit"class="btn btn-warning">Dejar de seguir</button>
        </form>
    {% else %}
        <form action="{% url 'blog:subscribe' profile_user.username %}" method="post">
            {% csrf_token %}
            <button type="submit" class="btn btn-success">Suscribirse</button>
        </form>
    {% endif %}
{% endif %}
{% endblock %}